<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WPM Quiz with Audio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  html, body {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body { 
    font-family: Arial, sans-serif; 
    padding: 30px; 
    font-size: 1.5em;
    padding-top: 40px;
    box-sizing: border-box;
  }

  h2, h3 {
    font-size: 1.5em;
  }

  #text { 
    border: 1px solid #ccc; 
    padding: 30px; 
    margin-bottom: 2.8em; /* 英文下の余白2行分 */
    background: #f9f9f9; 
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .audio-wrapper {
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 2.8em; /* プレイヤー下の余白2行分 */
  }
  audio {
    width: 100%;
    max-width: 800px;
    display: block;
    margin: 0 auto;
    background: #fff;
    box-sizing: border-box;
    z-index: 1000;
    padding: 10px 0;
    border: none;
  }

  button {
    font-size: 1.5em; 
    padding: 15px 30px;
    margin: 10px;
  }

  input[type="checkbox"] {
    transform: scale(1.5);
    margin-right: 10px;
  }

  #controls { 
    margin: 0 0 30px 0;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }
  #questions { 
    margin-top: 30px;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .question-option {
    display: block;
    margin-bottom: 18px;
  }

  #result {
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
    margin-top: 30px;
  }

  /* --- モバイル用スタイル --- */
  @media (max-width: 600px) {
    body { 
      padding-top: 20px;
      font-size: 1.1em;
      padding-left: 5px;
      padding-right: 5px;
    }
    #text, #controls, #questions, #result, .audio-wrapper {
      padding: 0 2vw;
      max-width: 100vw;
      margin-left: 0;
      margin-right: 0;
    }
    #text { padding: 15px 2vw; }
    .audio-wrapper { margin-bottom: 2.8em; }
    audio {
      width: 100vw;
      max-width: 100vw;
      margin: 0 0 0 0;
      padding: 0;
    }
    button {
      font-size: 1em;
      padding: 10px 16px;
    }
    input[type="checkbox"] {
      transform: scale(1.2);
    }
    .question-option {
      margin-bottom: 16px;
    }
  }
</style>
</head>
<body>

<h2 style="max-width:800px;margin:0 auto 30px auto;">Three-minute Training</h2>

<!-- テキスト -->
<div id="text">
【16】Takaichi Sanae has become Japan’s 104th prime minister. She is making news around the world because she is Japan’s first female prime minister. Takaichi grew up near Nara. She comes from a middle-class family and likes heavy metal bands. She is an amateur drummer. She spent some time in the U.S. before going into politics in Japan in 1993. She was very close to Abe Shinzo. One of her heroes is Margaret Thatcher, the first female British prime minister. Takaichi will not have an easy job as the head of the Japanese government. Inflation is bad, and her government cannot do anything without the help of other political parties. 
</div>

<!-- 音声再生（英文の下、ボタンの上） -->
<div class="audio-wrapper">
  <audio controls>
    <source src="16.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>
</div>

<div id="controls">
  <button onclick="startReading()">▶ Start</button>
  <button onclick="finishReading()">⏹ Finish</button>
</div>

<div id="questions">
  <h3>Quiz</h3>
  <label>Select all options below that match the content of the passage.</label></span>
  <span class="question-option"><input type="checkbox" class="q1" value="a"> Takaichi Sanae pursues music and spends time in the U.S. before entering politics.
</span>
  <span class="question-option"><input type="checkbox" class="q1" value="b"> Takaichi Sanae faces significant challenges as Japan’s first female prime minister and has a notable background.</span>
  <span class="question-option"><input type="checkbox" class="q1" value="c"> Abe Shinzo and Margaret Thatcher shape political legacies that influence Japan.</span>
  <span class="question-option"><input type="checkbox" class="q1" value="d"> Heavy metal culture rises among Japanese politicians. </span>
</div>

<div id="result"></div>

<script>
let startTime;
let wordCount = 0;

function startReading() {
  const text = document.getElementById("text").innerText.trim();
  wordCount = text.split(/\s+/).length;
  startTime = Date.now();
  document.getElementById("result").innerText = "Reading started...";
}

function finishReading() {
  if (!startTime) return alert("Please start reading first!");
  const elapsedSec = (Date.now() - startTime) / 1000;

  // 正解選択肢: a, b
  const correctAnswers = ["a", "b"];
  const checked = Array.from(document.querySelectorAll(".q1:checked")).map(el => el.value);
  const numCorrect = checked.filter(val => correctAnswers.includes(val)).length;
  const numIncorrect = checked.filter(val => !correctAnswers.includes(val)).length;
  const totalCorrect = correctAnswers.length;

  // 指定されたAccuracy計算
  let accuracy = ((numCorrect - numIncorrect) / totalCorrect) * 100;
  if (accuracy < 0) {
    accuracy = 0;
  }

  const rawWPM = (wordCount / elapsedSec) * 60;
  const finalWPM = Math.round(rawWPM * (accuracy / 100));

  document.getElementById("result").innerHTML =
    `Time: ${elapsedSec.toFixed(1)} sec<br>` +
    `Raw WPM: ${rawWPM.toFixed(1)}<br>` +
    `Accuracy: ${accuracy.toFixed(0)}%<br>` +
    `Final WPM (accuracy applied): ${finalWPM}`;
}
</script>

</body>
</html>









